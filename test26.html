<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<title>bonobo</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="ROBOTS" content="NOINDEX, NOFOLLOW">
<link rel="stylesheet" href="css/style.css">
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Tenor+Sans&family=Zen+Kaku+Gothic+New&display=swap" rel="stylesheet"> 
</head>
<body>

<div class="wrapper">
<div id="header"></div>
<div id="menubar">
<div id="navigation"></div>
</div>
<main>
<div class="zen-kaku-gothic-new-regular">


<section>

<form action="" method="post" id="contact_form">

<h2>APIテスト</h2>
<p>
  <span style="font-weight:bold;">■ 代理店コード</span>
</p>
  <br>

    <h2>顧客検索</h2>
    <input type="text" id="customerCode" placeholder="顧客コードを入力">
    <button onclick="fetchCustomerName()">検索</button>
    <p>顧客名: <span id="customerName"></span></p>
  
</form>

</section>

</div>
</main>

<div id="footer"></div>
</div>

<!--jQueryの読み込み-->
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>

<!--このテンプレート専用のスクリプト-->
<script src="js/main.js"></script>

<!--API専用のスクリプト-->  
    <script>
        async function fetchCustomerName() {
            const customerCode = document.getElementById("customerCode").value;
            if (!customerCode) {
                alert("顧客コードを入力してください");
                return;
            }

            const apiUrl = `https://asiro-ssi.viewer.kintoneapp.com/public/api/records/agentnumber/1  ?customerCode=${customerCode}`;
            
            try {
                const response = await fetch(apiUrl);
                if (!response.ok) throw new Error("データ取得に失敗しました");

                const data = await response.json();
                if (data.length === 0) {
                    document.getElementById("customerName").textContent = "該当なし";
                } else {
                    document.getElementById("customerName").textContent = data[0].customerName;
                }
            } catch (error) {
                console.error("エラー:", error);
                document.getElementById("customerName").textContent = "エラーが発生しました";
            }
        }
    </script>
  
<!--ページの上部へ戻るボタン-->
<div class="pagetop"><a href="#"><i class="fas fa-angle-double-up"></i></a></div>

 
</body>
</html>
